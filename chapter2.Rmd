# Regression and model validation

*Describe the work you have done this week and summarize your learning.*

- Describe your work and results clearly. 
- Assume the reader has an introductory course level understanding of writing and reading R code as well as statistical methods.
- Assume the reader has no previous knowledge of your data or the more advanced methods you are using.

```{r}
date()
```
# the token to fix the connection

# usethis::create_github_token()
gitcreds::gitcreds_set()

# read the file

```{r}
list.files()
student2014 <- read.csv("data2.csv", header = TRUE, sep = ",")
dim(student2014)
str(student2014)
```
 
# Data is from an international survey of Approaches to Learning, made possible by Teachers and is  used as a course material in
# a course calles Introduction  to open data science. 
# dataset has seven variables two of which are integers and four of which are numerical variables. One variable describing gender is categorical. 

# variable contets briefly: 
# gender = gender of the respondent
# age = age of the respondent
# attitude = Global attitude toward statistics/10
# deep = mean of the values related to deep learning methods
# stra = mean of the values related to strategic learning methods
# surf = mean of the values related to surface learning methods
# points = exam points

# Graphic overview

```{r}
library("ggplot2")
library("GGally")

ggpairs(student2014, lower = list(combo = wrap("facethist", bins = 20)))
```

# Significant correlations: a
# attitude and points correlate (R = 0.437***)
# deep and surf correlate (R = -0.324***)
# stra and surf correlate (R = -0.161*)

# Further focus on pairs with significant correlations and regression lines. 
```{r}
#Access the gglot2 library
library(ggplot2)

# initialize plot with data and aesthetic mapping
p1 <- ggplot(student2014, aes(x = attitude, y = points))+
  geom_point()+
  geom_smooth(method = "lm")+
  ggtitle("Student's attitude vs. exam points")

p1

```

# Students that had a higher points with attitude obtained also higher exam points. 

```{r}
p2 <- ggplot(student2014, aes(x = deep, y = surf))+
  geom_point()+
  geom_smooth(method = "lm")+
  ggtitle("Correlation between deep and surface learning methods")

p2

```

# Students that used more surface learning techniques used less likely deep learning techniques. 

```{r}
p3 <- ggplot(student2014, aes(x = stra, y = surf))+
  geom_point()+
  geom_smooth(method = "lm")+
  ggtitle("Correlation between strategic and surface learning methods")

p3

```

# Students that used surface techniques used strategic techniques less likely. 

# Testing the model 

# The selected three explanatory variables are: stra, surf and deep. Response variable is points

```{r}
my_model <- lm(points ~ attitude + stra + surf + deep, data = student2014)
summary(my_model)

```

# Only attitude seems to correlate with the exam points on *** (p<0.001)

# Removing the excess of variables from the model 

```{r}
my_model2 <- lm(points ~ attitude, data = student2014)
summary(my_model2)

```

# Now the model fits the data better